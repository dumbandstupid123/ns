<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resource Finder • Housing Counselor</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-blue: #007AFF;
            --primary-green: #34C759;
            --light-blue: #E3F2FD;
            --light-green: #E8F5E8;
            --dark-blue: #0056CC;
            --dark-green: #28A745;
            --text-primary: #1D1D1F;
            --text-secondary: #6E6E73;
            --background: #F2F2F7;
            --card-background: #FFFFFF;
            --border-color: #E5E5E7;
            --shadow-light: 0 2px 16px rgba(0, 0, 0, 0.04);
            --shadow-medium: 0 8px 32px rgba(0, 0, 0, 0.08);
            --shadow-heavy: 0 16px 64px rgba(0, 0, 0, 0.12);
            --radius: 16px;
            --radius-large: 24px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            background: var(--background);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }

        /* Header */
        .header {
            background: var(--card-background);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            backdrop-filter: blur(20px);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .back-button {
            width: 40px;
            height: 40px;
            border: none;
            background: var(--background);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: var(--text-secondary);
            transition: all 0.2s ease;
        }

        .back-button:hover {
            background: var(--border-color);
            color: var(--text-primary);
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .header-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .header-icon svg {
            width: 24px;
            height: 24px;
            color: white;
        }

        .header-text h1 {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.125rem;
        }

        .header-text p {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        /* Main Container */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Form Section */
        .form-section {
            background: var(--card-background);
            border-radius: var(--radius-large);
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border-color);
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .section-title {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .section-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
        }

        .form-grid {
            display: grid;
            gap: 2rem;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-label .icon {
            width: 16px;
            height: 16px;
            color: var(--primary-green);
        }

        .form-select {
            padding: 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            font-size: 1rem;
            color: var(--text-primary);
            background: var(--card-background);
            transition: all 0.2s ease;
            cursor: pointer;
        }

        .form-select:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 0 3px rgba(52, 199, 89, 0.1);
        }

        /* Checkbox Groups */
        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--background);
            border-radius: var(--radius);
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .checkbox-item:hover {
            border-color: var(--border-color);
        }

        .checkbox-item.checked {
            border-color: var(--primary-green);
            background: var(--light-green);
        }

        .checkbox-input {
            display: none;
        }

        .checkbox-mark {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
        }

        .checkbox-item.checked .checkbox-mark {
            background: var(--primary-green);
            border-color: var(--primary-green);
        }

        .checkbox-mark svg {
            width: 12px;
            height: 12px;
            color: white;
            opacity: 0;
            transition: opacity 0.2s ease;
        }

        .checkbox-item.checked .checkbox-mark svg {
            opacity: 1;
        }

        .checkbox-label {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-primary);
        }

        /* Action Button */
        .form-actions {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
        }

        .find-button {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            color: white;
            border: none;
            border-radius: var(--radius);
            padding: 1.25rem 3rem;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: var(--shadow-medium);
        }

        .find-button:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-heavy);
        }

        .find-button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        /* Loading States */
        .spinner {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Results Section */
        .results-section {
            display: none;
            background: var(--card-background);
            border-radius: var(--radius-large);
            box-shadow: var(--shadow-medium);
            border: 1px solid var(--border-color);
            overflow: hidden;
        }

        .results-header {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            padding: 2rem;
            text-align: center;
            color: white;
        }

        .results-title {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .results-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
        }

        .results-content {
            padding: 2rem;
        }

        .resource-grid {
            display: grid;
            gap: 1.5rem;
        }

        .resource-item {
            background: var(--background);
            border-radius: var(--radius);
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
        }

        .resource-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-medium);
        }

        .resource-image {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            overflow: hidden;
        }

        .resource-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .resource-image .placeholder {
            width: 64px;
            height: 64px;
            color: white;
            opacity: 0.8;
        }

        .resource-content {
            padding: 1.5rem;
        }

        .resource-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
        }

        .resource-description {
            font-size: 0.875rem;
            color: var(--text-secondary);
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .resource-contact {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .contact-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .contact-item .icon {
            width: 16px;
            height: 16px;
            color: var(--primary-green);
        }

        .contact-link {
            color: var(--primary-blue);
            text-decoration: none;
            font-weight: 500;
        }

        .contact-link:hover {
            text-decoration: underline;
        }

        /* New Search Button */
        .new-search {
            display: flex;
            justify-content: center;
            margin-top: 2rem;
        }

        .new-search-button {
            background: var(--background);
            color: var(--text-primary);
            border: 2px solid var(--border-color);
            border-radius: var(--radius);
            padding: 0.75rem 1.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .new-search-button:hover {
            background: var(--border-color);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                padding: 1rem;
            }

            .form-section {
                padding: 1.5rem;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .checkbox-group {
                grid-template-columns: 1fr;
            }

            .section-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-left">
            <button class="back-button" onclick="goBack()">
                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M19 12H5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <path d="M12 19L5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </button>
            
            <div class="header-title">
                <div class="header-icon">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 10C21 17 12 23 12 23S3 17 3 10A9 9 0 0 1 21 10Z" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                </div>
                <div class="header-text">
                    <h1>Resource Finder</h1>
                    <p>Find personalized housing resources</p>
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- Form Section -->
        <div id="formSection" class="form-section">
            <div class="section-header">
                <h2 class="section-title">Tell us about your housing needs</h2>
                <p class="section-subtitle">We'll find the best resources for your specific situation</p>
            </div>

            <div class="form-grid">
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            How urgently do you need housing?
                        </label>
                        <select id="urgency" class="form-select" required>
                            <option value="">Select urgency level...</option>
                            <option value="tonight">🚨 Tonight (Emergency)</option>
                            <option value="within-week">📅 Within a week</option>
                            <option value="within-month">📆 Within a month</option>
                            <option value="planning">🗓️ Planning ahead</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M20 21V19C20 17.9391 19.5786 16.9217 18.8284 16.1716C18.0783 15.4214 17.0609 15 16 15H8C6.93913 15 5.92172 15.4214 5.17157 16.1716C4.42143 16.9217 4 17.9391 4 19V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Who needs housing?
                        </label>
                        <select id="household" class="form-select" required>
                            <option value="">Select household type...</option>
                            <option value="single">👤 Just me (single adult)</option>
                            <option value="pregnant">🤱 Pregnant woman</option>
                            <option value="family-children">👨‍👩‍👧‍👦 Family with children</option>
                            <option value="couple">👫 Couple (no children)</option>
                            <option value="elderly">👵 Senior citizen</option>
                        </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 2V6M12 18V22M4.22 4.22L6.34 6.34M17.66 17.66L19.78 19.78M2 12H6M18 12H22M4.22 19.78L6.34 17.66M17.66 6.34L19.78 4.22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                            Monthly income range
                        </label>
                        <select id="income" class="form-select">
                            <option value="">Select income range...</option>
                            <option value="none">💸 No income</option>
                            <option value="under-1000">💵 Under $1,000</option>
                            <option value="1000-2000">💰 $1,000 - $2,000</option>
                            <option value="2000-3000">💳 $2,000 - $3,000</option>
                            <option value="over-3000">🏦 Over $3,000</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label">
                            <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 10C21 17 12 23 12 23S3 17 3 10A9 9 0 0 1 21 10Z" stroke="currentColor" stroke-width="2"/>
                                <circle cx="12" cy="10" r="3" stroke="currentColor" stroke-width="2"/>
                            </svg>
                            Preferred area in Houston
                        </label>
                        <select id="location" class="form-select">
                            <option value="">Any area...</option>
                            <option value="downtown">🏙️ Downtown Houston</option>
                            <option value="north">🧭 North Houston</option>
                            <option value="south">🗺️ South Houston</option>
                            <option value="east">📍 East Houston</option>
                            <option value="west">🌆 West Houston</option>
                            <option value="suburbs">🏘️ Suburbs</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="12" r="9" stroke="currentColor" stroke-width="2"/>
                        </svg>
                        Do any of these apply to you? (Check all that apply)
                    </label>
                    <div class="checkbox-group">
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'veteran')">
                            <input type="checkbox" class="checkbox-input" value="veteran">
                            <div class="checkbox-mark">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span class="checkbox-label">🎖️ Military veteran</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'domestic-violence')">
                            <input type="checkbox" class="checkbox-input" value="domestic-violence">
                            <div class="checkbox-mark">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span class="checkbox-label">🛡️ Fleeing domestic violence</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'disabled')">
                            <input type="checkbox" class="checkbox-input" value="disabled">
                            <div class="checkbox-mark">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span class="checkbox-label">♿ Person with disability</span>
                        </div>
                        <div class="checkbox-item" onclick="toggleCheckbox(this, 'youth')">
                            <input type="checkbox" class="checkbox-input" value="youth">
                            <div class="checkbox-mark">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 12L11 14L15 10" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span class="checkbox-label">🧑 Youth (18-24)</span>
                        </div>
                    </div>
                </div>

                <div class="form-actions">
                    <button class="find-button" onclick="findResources()">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
                            <path d="M21 21L16.65 16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        Find My Housing Resources
                    </button>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div id="resultsSection" class="results-section">
            <div class="results-header">
                <h2 class="results-title">Your Personalized Housing Resources</h2>
                <p class="results-subtitle">We found resources specifically matched to your situation</p>
            </div>
            <div class="results-content">
                <div id="resultsGrid" class="resource-grid">
                    <!-- Results will be populated here -->
                </div>
                <div class="new-search">
                    <button class="new-search-button" onclick="newSearch()">
                        ← Start New Search
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function goBack() {
            window.history.back();
        }

        function toggleCheckbox(element, value) {
            const checkbox = element.querySelector('.checkbox-input');
            checkbox.checked = !checkbox.checked;
            element.classList.toggle('checked', checkbox.checked);
        }

        function resetForm() {
            document.getElementById('urgency').value = '';
            document.getElementById('household').value = '';
            document.getElementById('income').value = '';
            document.getElementById('location').value = '';
            
            // Reset checkboxes
            const checkboxItems = document.querySelectorAll('.checkbox-item');
            checkboxItems.forEach(item => {
                item.classList.remove('checked');
                item.querySelector('.checkbox-input').checked = false;
            });
        }

        function newSearch() {
            document.getElementById('formSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            resetForm();
        }

        async function findResources() {
            // Collect form data
            const urgency = document.getElementById('urgency').value;
            const household = document.getElementById('household').value;
            const income = document.getElementById('income').value;
            const location = document.getElementById('location').value;
            
            const populations = Array.from(document.querySelectorAll('.checkbox-input:checked'))
                .map(checkbox => checkbox.value);

            // Validate required fields
            if (!urgency || !household) {
                alert('Please fill in the urgency and household type fields.');
                return;
            }

            // Build query based on form data
            let query = `I need housing assistance. `;
            
            // Add urgency
            if (urgency === 'tonight') {
                query += `This is an emergency - I need shelter tonight. `;
            } else if (urgency === 'within-week') {
                query += `I need housing within a week. `;
            } else if (urgency === 'within-month') {
                query += `I need housing within a month. `;
            } else {
                query += `I'm planning ahead for housing. `;
            }

            // Add household type
            if (household === 'single') {
                query += `I'm a single adult. `;
            } else if (household === 'pregnant') {
                query += `I'm pregnant and need safe housing. `;
            } else if (household === 'family-children') {
                query += `I have a family with children. `;
            } else if (household === 'couple') {
                query += `I'm part of a couple without children. `;
            } else if (household === 'elderly') {
                query += `I'm a senior citizen. `;
            }

            // Add special populations
            if (populations.includes('veteran')) {
                query += `I'm a military veteran. `;
            }
            if (populations.includes('domestic-violence')) {
                query += `I'm fleeing domestic violence. `;
            }
            if (populations.includes('disabled')) {
                query += `I have a disability. `;
            }
            if (populations.includes('youth')) {
                query += `I'm a young adult (18-24). `;
            }

            // Add income if provided
            if (income) {
                if (income === 'none') {
                    query += `I have no income. `;
                } else if (income === 'under-1000') {
                    query += `My monthly income is under $1,000. `;
                } else if (income === '1000-2000') {
                    query += `My monthly income is $1,000-$2,000. `;
                } else if (income === '2000-3000') {
                    query += `My monthly income is $2,000-$3,000. `;
                } else if (income === 'over-3000') {
                    query += `My monthly income is over $3,000. `;
                }
            }

            // Add location preference
            if (location) {
                query += `I prefer housing in ${location.replace('-', ' ')}. `;
            }

            query += `Please provide specific housing resources with contact information, organized by priority and relevance to my situation.`;

            try {
                // Show loading state
                const findBtn = document.querySelector('.find-button');
                const originalText = findBtn.innerHTML;
                findBtn.innerHTML = '<svg class="spinner" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 2V6M12 18V22M4.93 4.93L7.76 7.76M16.24 16.24L19.07 19.07M2 12H6M18 12H22M4.93 19.07L7.76 16.24M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg> Finding your resources...';
                findBtn.disabled = true;

                const response = await fetch('http://localhost:8081/api/query', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        query: query
                    })
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }

                const data = await response.json();
                
                // Display results
                displayResults(data.response, { urgency, household, populations, income, location });

            } catch (error) {
                console.error('Error:', error);
                alert('Sorry, there was an error finding resources. Please try again.');
                
                // Reset button state
                const findBtn = document.querySelector('.find-button');
                findBtn.innerHTML = originalText;
                findBtn.disabled = false;
            }
        }

        function displayResults(responseText, criteria) {
            // Hide form and show results
            document.getElementById('formSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';

            // Parse the response and create beautiful resource cards
            const resultsGrid = document.getElementById('resultsGrid');
            
            // Create a beautiful formatted result
            const resourceCard = createResourceCard(responseText, criteria);
            resultsGrid.innerHTML = resourceCard;

            // Reset button state
            const findBtn = document.querySelector('.find-button');
            findBtn.innerHTML = '<svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/><path d="M21 21L16.65 16.65" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>Find My Housing Resources';
            findBtn.disabled = false;
        }

        function createResourceCard(responseText, criteria) {
            // Generate contextual image based on criteria
            const imageUrl = getContextualImage(criteria);
            const priorityIcon = getPriorityIcon(criteria.urgency);
            
            return `
                <div class="resource-item">
                    <div class="resource-image">
                        <img src="${imageUrl}" alt="Housing Resource" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="placeholder" style="display: none;">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M9 22V12H15V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    </div>
                    <div class="resource-content">
                        <div class="resource-title">
                            ${priorityIcon} Housing Resources for Your Situation
                        </div>
                        <div class="resource-description">
                            ${formatResponse(responseText)}
                        </div>
                        <div class="resource-contact">
                            <div class="contact-item">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M22 16.92V19.92C22.0011 20.1985 21.9441 20.4742 21.8325 20.7293C21.7209 20.9845 21.5573 21.2136 21.3521 21.4019C21.1468 21.5901 20.9046 21.7335 20.6407 21.8227C20.3769 21.9119 20.0974 21.9451 19.82 21.92C16.7428 21.5856 13.787 20.5341 11.19 18.85C8.77382 17.3147 6.72533 15.2662 5.18999 12.85C3.49997 10.2412 2.44824 7.27099 2.11999 4.18C2.095 3.90347 2.12787 3.62476 2.21649 3.36162C2.30512 3.09849 2.44756 2.85669 2.63476 2.65162C2.82196 2.44655 3.0498 2.28271 3.30379 2.17052C3.55777 2.05833 3.83233 2.00026 4.10999 2H7.10999C7.59531 1.99522 8.06681 2.16708 8.43407 2.48353C8.80133 2.79999 9.04329 3.23945 9.10999 3.72C9.23663 4.68007 9.47145 5.62273 9.80999 6.53C9.94454 6.88792 9.97366 7.27691 9.8939 7.65088C9.81415 8.02485 9.62886 8.36811 9.35999 8.64L8.08999 9.91C9.51355 12.4135 11.5865 14.4864 14.09 15.91L15.36 14.64C15.6319 14.3711 15.9751 14.1858 16.3491 14.1061C16.7231 14.0263 17.1121 14.0555 17.47 14.19C18.3773 14.5286 19.3199 14.7634 20.28 14.89C20.7658 14.9585 21.2094 15.2032 21.5265 15.5775C21.8437 15.9518 22.0122 16.4296 22 16.92Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span>For immediate assistance, call 211 for Houston housing resources</span>
                            </div>
                            <div class="contact-item">
                                <svg class="icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
                                    <path d="M12 6V12L16 14" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                                <span>Resources updated for ${formatDate(new Date())}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getContextualImage(criteria) {
            // Return contextual images based on criteria
            if (criteria.urgency === 'tonight') {
                return 'https://images.unsplash.com/photo-1582407947304-fd86f028f716?w=400&h=200&fit=crop&auto=format';
            } else if (criteria.household === 'family-children') {
                return 'https://images.unsplash.com/photo-1560448204-e02f11c3d0e2?w=400&h=200&fit=crop&auto=format';
            } else if (criteria.populations.includes('veteran')) {
                return 'https://images.unsplash.com/photo-1636633762833-5d1658f1e29b?w=400&h=200&fit=crop&auto=format';
            } else {
                return 'https://images.unsplash.com/photo-1564013799919-ab600027ffc6?w=400&h=200&fit=crop&auto=format';
            }
        }

        function getPriorityIcon(urgency) {
            switch(urgency) {
                case 'tonight': return '🚨';
                case 'within-week': return '⚡';
                case 'within-month': return '📅';
                default: return '🏠';
            }
        }

        function formatResponse(text) {
            // Format the response text with better styling
            return text
                .replace(/\n/g, '<br>')
                .replace(/(\d{3}-\d{3}-\d{4})/g, '<a href="tel:$1" class="contact-link">$1</a>')
                .replace(/([\w\.-]+@[\w\.-]+\.\w+)/g, '<a href="mailto:$1" class="contact-link">$1</a>');
        }

        function formatDate(date) {
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Focus on first input
            document.getElementById('urgency').focus();
        });
    </script>
</body>
</html> 